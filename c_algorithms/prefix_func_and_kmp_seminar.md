# Префикс-функция
## Реализация на псевдокоде
```c
function PF(s)
    k = 0
    pi[1] = 0
    for i = 2 to |s| do
        while k > 0 and s[i] != s[k+1] do
            k = pi[k]
        end while
        if s[i] = s[k + 1] then
            k = k + 1
        end if
        pi[i] = k
    end for
    return pi
end function
```

## Обозначения и определение префикс-функции
`s` - строка 

`|s|` - **длина** строки 

`s[i]` - _i-ый_ символ `s` `(1 <= i <= |s|)`

`s[i, j]` - _подстрока_ с i по j символ

```c
pi(s)
pi(i) = max(среди всех k (0 <= k <= i) : s[1, k] = s[i - k + 1, i])
```

## Примеры
```
Определяем по строке s значения префикс-функции pi:
s  = ababacaba
pi = 001230123

s  = abadab cbda
pi = 00101200001

А теперь наоборот:
pi = 012001234
s  = aaabbaaab

pi = 0100101212
s  = aabbabaa?? => такая префикс-функция не может существовать
```

Задача: доказать лемму: ``pi[i + 1] <= pi[i] + 1``

Задача: какой минимальной длины должна быть префикс-функция, чтобы в минимальной лексикографической строке были как минимум 3 различные буквы?
Ответ: 4

```
000 010 012 001
abb abb aaa aba

0010
abac
```

## Доказательство лемм
Лемма 5. Доказать, что `pi[pi[|s|]]` - длина суффикса s, который также является ее префиксом. (_Подсказка: доказывать через рисунок строки_)

Лемма 6. Доказать, что не существует такого числа `l`, что `pi[pi[|s|]] < l < pi[|s|]` и `s[1,l]=s[|s| - l + 1, |s|]` (_Подсказка: доказывать от противного_)

Лемма 7. `pi[|s|], pi[pi[|s|]]`

## Зачем это все нужно?
Нужно для одной прикольной штучки - алгоритма Кнута-Морриса-Пратта

Пусть `x` и `t` - строки

Возьмем строку `s=x#t`, где # - символ, который не встречается в s и t.

Рассмотрим функцию pi(s):

1. `pi[i] <= |x|`
2. `pi[i] = |x|`